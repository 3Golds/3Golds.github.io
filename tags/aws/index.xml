<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>aws on èµµé‘«çš„åšå®¢</title>
    <link>http://zhaox.xyz/tags/aws/</link>
    <description>Recent content in aws on èµµé‘«çš„åšå®¢</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Mon, 30 Oct 2017 00:00:00 +0000</lastBuildDate>
    
	<atom:link href="http://zhaox.xyz/tags/aws/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>è§£å†³ AWS ELB å¶å‘çš„ 502 Bad Gateway é”™è¯¯</title>
      <link>http://zhaox.xyz/posts/aws-elb-502/</link>
      <pubDate>Mon, 30 Oct 2017 00:00:00 +0000</pubDate>
      
      <guid>http://zhaox.xyz/posts/aws-elb-502/</guid>
      <description>é—®é¢˜æè¿° åœ¨ä½¿ç”¨äº† Prometheus åšäº† HTTP åè®®çš„ç›‘æ§ä¹‹åï¼Œblackbox_exporter å¶å°”ä¼šæŠ¥ä¸€äº› ProbeDown çš„æŠ¥è­¦ï¼Œç»è¿‡æ£€æŸ¥æ˜¯ 502 Bad Gateway é”™è¯¯ï¼Œä½†æ­¤æ—¶åç«¯æ˜¯æ­£å¸¸çš„ï¼Œåªæ˜¯åœ¨ AWS ELB çš„ç›‘æ§æŒ‡æ ‡ä¸­ï¼Œçœ‹åˆ°äº† ELB HTTP 5xx ç›¸å…³é”™è¯¯ï¼Œå› æ­¤å›°æ‰°äº†ä¸€æ®µæ—¶é—´ã€‚
HTTP æ•°æ®æµå‘å¦‚ä¸‹ï¼š
 [Client] --- [ELB] --- [nginx] --- [App Servers]  æ’æŸ¥é—®é¢˜ æœ€å¼€å§‹æ˜¯æ€€ç–‘æ˜¯åç«¯é—®é¢˜ï¼Œä½†æ˜¯æŸ¥é˜…äº† nginx å’Œ App servers çš„æ—¥å¿—ï¼Œæ²¡æœ‰ä»»ä½•ç»“æœï¼Œåªæ˜¯åœ¨ ELB æ—¥å¿—é‡Œé¢æ‰¾åˆ°äº† 502 Bad Gateway çš„é”™è¯¯ä¿¡æ¯ã€‚æ— å¥ˆä¹‹ä¸‹ç”šè‡³æ€€ç–‘ nginx æ‰€åœ¨ EC2 instance æœ‰é—®é¢˜ï¼Œå› æ­¤æ±‚åŠ©äº† AWS æŠ€æœ¯æ”¯æŒã€‚æ ¹æ®å»ºè®®ï¼Œåœ¨ nginx è¿™ç«¯åšäº† tcpdump æŠ“åŒ…ï¼Œæœ€åç»ˆäºåœ¨ AWS æŠ€æœ¯æ”¯æŒçš„å¸®åŠ©ä¸‹ï¼Œå®šä½å¹¶è§£å†³äº†é—®é¢˜ ğŸ‰ã€‚
å…ˆè¡¥å……ä¸€ä¸ªçŸ¥è¯†ï¼šå¦‚æœåç«¯æ”¯æŒçš„è¯ï¼ŒELB ä¼šä½¿ç”¨ä¿æŒè¿æ¥ï¼ˆHTTP persistent/keep-alive connectionsï¼‰ã€‚æ¥çœ‹çœ‹è¿™ä¸€ä¸ªä¿æŒè¿æ¥çš„ TCP streamï¼š
å…¶ä¸­ï¼Œ10.100.2.186 æ˜¯ ELB å†…éƒ¨ IPï¼Œ10.</description>
    </item>
    
    <item>
      <title>AWS EBS åœ¨çº¿æ‰©å®¹</title>
      <link>http://zhaox.xyz/posts/2017-02-17-aws-%E5%9C%A8%E7%BA%BF%E6%89%A9%E5%AE%B9/</link>
      <pubDate>Fri, 17 Feb 2017 00:00:00 +0000</pubDate>
      
      <guid>http://zhaox.xyz/posts/2017-02-17-aws-%E5%9C%A8%E7%BA%BF%E6%89%A9%E5%AE%B9/</guid>
      <description>AWS Management Console æ‰©å®¹ ebs å®¹é‡ åŸæ–‡è¿æ¥ï¼šhttps://aws.amazon.com/blogs/aws/amazon-ebs-update-new-elastic-volumes-change-everything/
1.é€‰æ‹©æ‰©å®¹è®¾å¤‡ 2.ä¿®æ”¹æ‰©å®¹å®¹é‡ 4.ç­‰å¾…å…¶çŠ¶æ€è¾¾åˆ° 100% æ‰©å®¹ç£ç›˜åˆ†åŒº growpart
 growpart /dev/xvdf 1  parted
 GNU Parted 2.3 Using /dev/xvdf1 Welcome to GNU Parted! Type &#39;help&#39; to view a list of commands. (parted) print Model: Unknown (unknown) Disk /dev/xvdf1: 80.7GB Sector size (logical/physical): 512B/512B Partition Table: loop Number Start End Size File system Flags 1 0.00B 53.7GB 53.7GB ext4 (parted) resizepart 1 80.7GB # resizepart NUMBER END Warning: Partition /dev/xvdf1 is being used.</description>
    </item>
    
    <item>
      <title>aws-ec2-åŒç½‘å¡é—®é¢˜y</title>
      <link>http://zhaox.xyz/posts/2017-01-12-aws-ec2-%E5%8F%8C%E7%BD%91%E5%8D%A1%E9%97%AE%E9%A2%98/</link>
      <pubDate>Thu, 12 Jan 2017 00:00:00 +0000</pubDate>
      
      <guid>http://zhaox.xyz/posts/2017-01-12-aws-ec2-%E5%8F%8C%E7%BD%91%E5%8D%A1%E9%97%AE%E9%A2%98/</guid>
      <description>é—®é¢˜æè¿° åœ¨å·²å­˜åœ¨çš„ EC2 ä¸Šæ–°æ·»åŠ ç½‘å¡åå‘ç°ï¼Œå‡¡æ˜¯å’Œ eth0 åœ¨åŒä¸€ä¸ªç½‘æ®µçš„åªèƒ½é€šè¿‡ eth0 è®¿é—®ï¼Œä¸èƒ½é€šè¿‡ eth1ã€‚åŒæ ·çš„ï¼Œåœ¨ eth1 ç½‘æ®µçš„åªèƒ½é€šè¿‡ eth1 è®¿é—®ï¼Œä¸èƒ½é€šè¿‡ eth0 è®¿é—®ã€‚ å¦‚æœæ—¢ä¸åœ¨ eth0 ä¹Ÿä¸å† eth0 é»˜è®¤èµ° eth0(åœ¨æ²¡æœ‰ä¿®æ”¹è·¯ç”±è¡¨çš„å‰æä¸‹ï¼Œé»˜è®¤è·¯ç”±æ˜¯ eth0)
é—®é¢˜åˆ†æ ä¹‹æ‰€ä»¥å‡ºç°æ‚¨åˆ—å‡ºçš„ç½‘ç»œè®¿é—®ç°è±¡ï¼Œæ˜¯å› ä¸ºç›®å‰çš„å®ä¾‹å½“ä¸­æœ‰ä¸¤å—ç½‘å¡ï¼Œè€Œå‘ç”Ÿæ•…éšœçš„æ—¶å€™ï¼Œè·¯ç”±çš„èµ°å‘æ˜¯ä»ç½‘å¡ 2 è¿›æ¥çš„æ•°æ®åŒ…ä»ç½‘å¡ 1 å‘é€å‡ºå»ï¼Œæˆ–è€…ä»ç½‘å¡ 1 è¿›æ¥çš„æ•°æ®åŒ…ä»ç½‘å¡ 2 å‘é€å‡ºå»ï¼ŒAWS åº•å±‚ä¼šæŠŠè¿™æ ·çš„æ•°æ®åŒ…ä¸¢å¼ƒã€‚
å› æ­¤éœ€è¦æ‰‹åŠ¨å®šä¹‰ç­–ç•¥è·¯ç”±ï¼Œåœ¨å“åº”ç½‘å¡ 1 è¿›æ¥çš„æ•°æ®åŒ…æ—¶é€šè¿‡ç½‘å¡ 1 å‘é€ï¼Œå“åº”ç½‘å¡ 2 è¿›æ¥çš„æ•°æ®åŒ…æ—¶é€šè¿‡ç½‘å¡ 2 å‘é€ã€‚
è§£å†³æ–¹æ¡ˆ å…³äºè¿™ä¸ªç°è±¡å’Œè§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å‚è€ƒè¿™éæ–‡æ¡£ï¼š
http://www.linuxjournal.com/article/7291
è¯¥æ–‡æ¡£è¾ƒé•¿ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªé…ç½®è·¯ç”±ç­–ç•¥çš„äº‹ä¾‹ï¼Œå¯ä»¥æŒ‰ç…§æ­¤äº‹ä¾‹çš„æ–¹æ³•ç»“åˆå…·ä½“ç½‘ç»œç¯å¢ƒè¿›è¡Œé…ç½®ï¼š
1ã€é¦–å…ˆä¸ºç½‘å¡ 1 å’Œ 2 åˆ›å»ºå„è‡ªçš„è·¯ç”±è¡¨ï¼š  ip route add [å­ç½‘1ç½‘æ®µ] via [æ‚¨å­ç½‘çš„ç½‘å…³IP] dev eth0 tab 1 ip route add [å­ç½‘2ç½‘æ®µ] via [æ‚¨å­ç½‘çš„ç½‘å…³IP] dev eth1 tab 2 å¯ä»¥é€šè¿‡ip route show table 1å’Œip route show table 2æŸ¥çœ‹æ‚¨åˆšåˆšå®Œæˆçš„é…ç½®æ˜¯å¦æ­£ç¡®  2ã€ç„¶ååˆ›å»ºç­–ç•¥è·¯ç”±  ip rule add from [eth0çš„IP]/32 tab 1 priority 500 ip rule add from [eth1çš„IP]/32 tab 2 priority 600  è¿™ä¸ªé…ç½®çš„æ„æ€æ˜¯ï¼Œå°†åŸåœ°å€ä¸º eth0 çš„ IP çš„åŒ…æŒ‰ç…§è·¯ç”±è¡¨ 1 å‘é€,å°†åŸåœ°å€ä¸º eth1 çš„ IP çš„åŒ…æŒ‰ç…§è·¯ç”±è¡¨ 2 å‘é€</description>
    </item>
    
    <item>
      <title>awsè‡ªå®šä¹‰AMI-UUIDç›¸åŒå¤„ç†æ–¹æ³•</title>
      <link>http://zhaox.xyz/posts/2017-01-12-aws%E8%87%AA%E5%AE%9A%E4%B9%89ami-uuid%E7%9B%B8%E5%90%8C%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/</link>
      <pubDate>Thu, 12 Jan 2017 00:00:00 +0000</pubDate>
      
      <guid>http://zhaox.xyz/posts/2017-01-12-aws%E8%87%AA%E5%AE%9A%E4%B9%89ami-uuid%E7%9B%B8%E5%90%8C%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/</guid>
      <description>Note: åœ¨åˆ¶ä½œ Centos 7 AMI å¹¶è¿›è¡Œä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å‘ç°ï¼šå¦‚æœå°†ä¸¤ä¸ªç›¸åŒ AMI æŒ‚è½½åˆ°ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼Œä¼šå‡ºç°å› ä¸º UUID ç›¸åŒï¼Œå¯¼è‡´ä¸èƒ½æŒ‚è½½çš„é—®é¢˜(è‡³äºä¸ºä»€ä¹ˆå°†ä¸¤ä¸ªç›¸åŒçš„ AMI æŒ‚è½½åˆ°ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼šå½“è¯¯åˆ é™¤ç”¨æˆ·çš„å¯†é’¥æ–‡ä»¶æˆ–è€…ä¸èƒ½ç™»å½•ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å°†å…¶æŒ‚è½½åˆ°å…¶ä»–æ“ä½œç³»ç»Ÿ)
 é—®é¢˜é‡ç°  $ sudo fdisk -l Disk /dev/xvda: 53.7 GB, 53687091200 bytes, 104857600 sectors Units = sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk label type: dos Disk identifier: 0x0001783d Device Boot Start End Blocks Id System /dev/xvda1 * 2048 104856254 52427103+ 83 Linux Disk /dev/mapper/docker-202:1-84149041-pool: 107.</description>
    </item>
    
  </channel>
</rss>